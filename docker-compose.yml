version: "3.9"
services:
  rag:
    build:
      context: .
      dockerfile: Dockerfile.microservice
    environment:
      - ART_DIR=/data/art
    ports: ["9909:9909"]
    volumes:
      - ./data:/data
  gateway:
    build:
      context: .
      dockerfile: Dockerfile.gateway
    environment:
      - RAG_BASE=http://rag:9909
      - GATEWAY_PORT=9910
    depends_on: [rag]
    ports: ["9910:9910"]
  overseer:
    image: python:3.12-slim
    working_dir: /app
    command: ["python","overseer.py"]
    volumes:
      - ./:/app
    environment:
      - OVERSEER_PORT=9912
    ports: ["9912:9912"]
