# --- build ---
FROM rust:1.80 as builder
WORKDIR /app
COPY gateway/ ./gateway/
WORKDIR /app/gateway
RUN cargo build --release

# --- runtime ---
FROM gcr.io/distroless/cc as runtime
WORKDIR /app
COPY --from=builder /app/gateway/target/release/gateway /app/gateway
ENV GATEWAY_PORT=9910
ENV RAG_BASE=http://mock-rag:9909
# ENV GATEWAY_ADMIN_TOKEN=changeme
EXPOSE 9910
ENTRYPOINT ["/app/gateway"]
